REPORT zcreate_order_idoc.

DATA: ls_ctrl TYPE edi_dc40, 
      lt_data TYPE STANDARD TABLE OF edi_dd40,
      ls_data TYPE edi_dd40.
DATA: ls_e1edk01 TYPE e1edk01,
      ls_e1edka1 TYPE e1edka1,
      ls_e1edp01 TYPE e1edp01,
      ls_e1edp19 TYPE e1edp19.

* Populate control record
ls_ctrl-mandt   = sy-mandt.
ls_ctrl-idoctyp = 'ORDERS05'.
ls_ctrl-mestyp  = 'ORDERS'.
ls_ctrl-mescod  = ''.
ls_ctrl-mesfct  = ''.
ls_ctrl-sndprt  = 'LS'.           " sender type Logical System
ls_ctrl-sndprn  = 'EXTSYS'.       " sender partner name
ls_ctrl-sndpor  = 'EXTSYS'.       " sender port (could be same as logical system)
ls_ctrl-rcvprt  = 'LS'.           " receiver type Logical System
ls_ctrl-rcvprn  = 'MYECC'.        " receiver partner (e.g. this SAP system logical name)
ls_ctrl-rcvpor  = 'SAPMYECC'.     " receiver port (e.g. system ID)
ls_ctrl-direct  = '2'.            " inbound
ls_ctrl-test    = ' '.            " set to 'T' for test mode if needed

* Header segment E1EDK01
CLEAR ls_e1edk01.
ls_e1edk01-curcy  = 'USD'.        " Order currency
ls_e1edk01-zterm  = 'C010'.       " Payment terms code
ls_e1edk01-belnr  = 'PO-12345'.   " Customer PO number
ls_e1edk01-bsart  = 'OR'.         " Order type if needed (optional, e.g. OR = Standard Order)
" Move header to data record
CLEAR ls_data.
ls_data-segnam = 'E1EDK01'.
ls_data-sdata  = ls_e1edk01.      " move corresponding fields into raw data
APPEND ls_data TO lt_data.

* Organizational data E1EDK14 (Sales Org, Dist Ch, Division)
DATA: ls_e1edk14 TYPE e1edk14.
ls_e1edk14-qualf = '008'.         " Sales org
ls_e1edk14-orgid = '1000'.        " Sales Org ID
CLEAR ls_data.
ls_data-segnam = 'E1EDK14'.
ls_data-sdata  = ls_e1edk14.
APPEND ls_data TO lt_data.
" (Similarly add E1EDK14 for QUALF '007' = Dist Channel, '006' = Division if needed)

* Partner segment E1EDKA1 - Sold-to (AG)
CLEAR ls_e1edka1.
ls_e1edka1-parvw = 'AG'.
ls_e1edka1-partn = 'CUST1000'.    " Customer number (sold-to)
ls_e1edka1-name1 = 'Customer Inc'. " (Optionally fill name/address if needed)
ls_e1edka1-land1 = 'US'.
CLEAR ls_data.
ls_data-segnam = 'E1EDKA1'.
ls_data-sdata  = ls_e1edka1.
APPEND ls_data TO lt_data.

* Partner segment E1EDKA1 - Ship-to (WE)
ls_e1edka1-parvw = 'WE'.
ls_e1edka1-partn = 'CUST1000'.    " Ship-to party (could be same as AG or another)
CLEAR ls_data.
ls_data-segnam = 'E1EDKA1'.
ls_data-sdata  = ls_e1edka1.
APPEND ls_data TO lt_data.

* Item segment E1EDP01 - Item 000010
CLEAR ls_e1edp01.
ls_e1edp01-POSEX = '000010'.
ls_e1edp01-menge = '10.0'.       " quantity 10
ls_e1edp01-menee = 'EA'.        " unit of measure Each
" Optionally, if price to be taken from IDoc:
* ls_e1edp01-vprei = '100.00'.   " net price
* ls_e1edp01-netwr = '1000.00'.  " net value = price * qty
ls_e1edp01-werks = 'US01'.      " delivering plant
CLEAR ls_data.
ls_data-segnam = 'E1EDP01'.
ls_data-sdata  = ls_e1edp01.
APPEND ls_data TO lt_data.

* Item identification segment E1EDP19 with supplier material (QUALF 002)
CLEAR ls_e1edp19.
ls_e1edp19-qualf = '002'. 
ls_e1edp19-idtnr = 'MAT-1000'.   " assume this is a valid SAP material number
CLEAR ls_data.
ls_data-segnam = 'E1EDP19'.
ls_data-sdata  = ls_e1edp19.
APPEND ls_data TO lt_data.

* If needed, add schedule line E1EDP20, additional IDoc segments, etc., in similar fashion

" Call inbound IDoc processing FM
CALL FUNCTION 'IDOC_INBOUND_SINGLE'
  EXPORTING
    pi_idoc_control_rec_40 = ls_ctrl
  TABLES
    pt_idoc_data_records_40 = lt_data
  EXCEPTIONS
    error_idoc_control = 1
    error_idoc_data    = 2
    idoc_not_saved     = 3
    OTHERS             = 4.

IF sy-subrc = 0.
  COMMIT WORK.
  WRITE: / 'IDoc submitted, check WE02 for status.'.
ELSE.
  ROLLBACK WORK.
  WRITE: / 'Error in IDoc submission, SY-SUBRC:', sy-subrc.
ENDIF.